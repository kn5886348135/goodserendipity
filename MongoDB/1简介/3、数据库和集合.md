​		MongoDB把数据存储在文档(特指[BSON文档](https://docs.mongodb.com/manual/core/document/#std-label-bson-document-format))中，这些文档都聚集在一个[集合](https://docs.mongodb.com/manual/reference/glossary/#std-term-collection)中。一个[数据库](https://docs.mongodb.com/manual/reference/glossary/#std-term-database)中存储一个或者多个集合的文档。



切换数据库 use myDB

创建数据库	切换到一个并不存在的数据库myNewDB，然后执行插入操作，MongoDB会创建一个数据库和集合。

use myNewDB

db.myNewCollection1.insertOne( { x: 1 } )

数据库和集合必须遵循[命名规范](https://docs.mongodb.com/manual/reference/limits/#std-label-restrictions-on-db-names)。



创建集合

db.myNewCollection2.insertOne( { x: 1 } )
db.myNewCollection3.createIndex( { y: 1 } )



显式创建

MongoDB提供显式创建方法 [`db.createCollection()`](https://docs.mongodb.com/manual/reference/method/db.createCollection/#mongodb-method-db.createCollection)，可以指定很多选项，比如最大文档数量校验规则。可以通过[`collMod`](https://docs.mongodb.com/manual/reference/command/collMod/#mongodb-dbcommand-dbcmd.collMod)修改这些选项。



文档校验(3.2版本添加)

​		默认情况下，集合不要求文档有一样的模式，单个集合中的文档不需要拥有同样的属性集，集合中所有文档的属性的数据类型都可以不一样。从3.2版本开始，可以在更新和插入操作的时候对一个集合执行[文档校验规则](https://docs.mongodb.com/manual/core/schema-validation/)。[模式校验](https://docs.mongodb.com/manual/core/schema-validation/)详情。



修改文档结构

​		改变一个集合中的所有文档结构，比如增加、删除一个属性，改变一个属性值的类型，将文档编程一个新的结构。



唯一标志符(3.6版本添加)

​		集合被赋予一个不可变的UUID，集合UUID在所有副本集合、分片中保持一样。

 [listCollections](https://docs.mongodb.com/manual/reference/command/listCollections/)或者[`db.getCollectionInfos()`](https://docs.mongodb.com/manual/reference/method/db.getCollectionInfos/#mongodb-method-db.getCollectionInfos)可以获得集合UUID。





### 视图

​		视图是一个可查询的对象，它的内容由其他集合或者视图上的[聚合管道](https://docs.mongodb.com/manual/core/aggregation-pipeline/#std-label-aggregation-pipeline)定义。MongoDB不会将视图内容持久化到磁盘上。当一个客户端查询视图的时候，视图的内容是按照需要计算的。MongoDB可以要求客户端必须拥有[权限](https://docs.mongodb.com/manual/core/authorization/#std-label-authorization)才能查询视图。MongoDB不支持对视图的写操作。比如

​	1、可以创建一个排除隐私或者个人信息(private or personal information，PPI)的雇员集合的数据，应用可以查询不包含PPI的雇员数据的视图。

​	2、在一个收集了高级数据，添加计算属性和统计的集合上创建视图，应用可以使用简单的查询操作查询数据。

​	3、创建一个连接两个分别包含库存和订单的集合的视图，应用不需要管理或者理解潜在的复杂管道就可以查询关联数据。

​		当客户端查询视图的时候，MongoDB把客户端查询拼接在潜在的管道后面，返回返回拼接后的管道的结果到客户端。MongoDB可能会在拼接后的管道上使用[聚合管道优化](https://docs.mongodb.com/manual/core/aggregation-pipeline-optimization/)。



创建或者定义视图 [`db.createCollection()`](https://docs.mongodb.com/manual/reference/method/db.createCollection/#mongodb-method-db.createCollection) 

db.createCollection(
  "<viewName>",
  {
    "viewOn" : "<source>",
    "pipeline" : [<pipeline>],
    "collation" : { <collation> }
  }
)

[`db.createView()`](https://docs.mongodb.com/manual/reference/method/db.createView/#mongodb-method-db.createView)

db.createView(
  "<viewName>",
  "<source>",
  [<pipeline>],
  {
    "collation" : { <collation> }
  }
)

创建的视图必须和对应的集合在同一个数据库。视图定义管道不能包含[`$out`](https://docs.mongodb.com/manual/reference/operator/aggregation/out/#mongodb-pipeline-pipe.-out)或者[`$merge`](https://docs.mongodb.com/manual/reference/operator/aggregation/merge/#mongodb-pipeline-pipe.-merge)阶段。如果视图定义包含嵌套管道(例如视图定义包含 [`$lookup`](https://docs.mongodb.com/manual/reference/operator/aggregation/lookup/#mongodb-pipeline-pipe.-lookup)或者[`$facet`](https://docs.mongodb.com/manual/reference/operator/aggregation/facet/#mongodb-pipeline-pipe.-facet)阶段)，这个限制也会应用到嵌套的管道中。



##### 视图操作

只读，写操作会报错。

- [`db.collection.find()`](https://docs.mongodb.com/manual/reference/method/db.collection.find/#mongodb-method-db.collection.find)
- [`db.collection.findOne()`](https://docs.mongodb.com/manual/reference/method/db.collection.findOne/#mongodb-method-db.collection.findOne)
- [`db.collection.aggregate()`](https://docs.mongodb.com/manual/reference/method/db.collection.aggregate/#mongodb-method-db.collection.aggregate)
- [`db.collection.countDocuments()`](https://docs.mongodb.com/manual/reference/method/db.collection.countDocuments/#mongodb-method-db.collection.countDocuments)
- [`db.collection.estimatedDocumentCount()`](https://docs.mongodb.com/manual/reference/method/db.collection.estimatedDocumentCount/#mongodb-method-db.collection.estimatedDocumentCount)
- [`db.collection.count()`](https://docs.mongodb.com/manual/reference/method/db.collection.count/#mongodb-method-db.collection.count)
- [`db.collection.distinct()`](https://docs.mongodb.com/manual/reference/method/db.collection.distinct/#mongodb-method-db.collection.distinct)

索引和排序

​	视图使用潜在集合的索引

​	因为索引在潜在的视图上面，不允许直接在视图上创建、删除、重建索引或者获取这个视图上的很多索引。

​	