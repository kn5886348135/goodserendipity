#### 文档

​    MongoDB将数据记录存储为BSON文档。BSON是一个二进制的JSON文档展示，但是他比JSON包含更多的数据类型。参考[bsonspec.org](http://bsonspec.org/) 和  [BSON Types](https://docs.mongodb.com/manual/reference/bson-types/)。

![](crud-annotated-document.bakedsvg.svg)

​    MongoDB文档是由键值对组成的，结构如下：
```
{
   field1: value1,
   field2: value2,
   field3: value3,
   ...
   fieldN: valueN
}
```

​    属性的值可以使任意的BSON数据类型([data types](https://docs.mongodb.com/manual/reference/bson-types/))，包括其他的文档，数组，文档数组。例如下面的文档就包含不同的类型：
```
var mydoc = {
               _id: ObjectId("5099803df3f4948bd2f98391"),
               name: { first: "Alan", last: "Turing" },
               birth: new Date('Jun 23, 1912'),
               death: new Date('Jun 07, 1954'),
               contribs: [ "Turing machine", "Turing test", "Turingery" ],
               views : NumberLong(1250000)
            }
```

​    上面的属性有下面的数据类型：

- `_id` 持有 [ObjectId](https://docs.mongodb.com/manual/reference/bson-types/#std-label-objectid)。
- `name` 持有包含 `first` and `last` 的嵌入文档。
- `birth` 和 `death` 持有Date类型的值。
- `contribs` 持有一个字符串的数组。
- `views` 持有一个NumberLong类型的值。

属性名称

​    属性名称是字符串。

​    文档([Documents](https://docs.mongodb.com/manual/core/document/))对属性名称有如下的限制：

- 属性名`_id`是保留作为主键使用，它的值必须是集合中唯一的、不可变的，可以是除了数组的任何类型。

- 属性名不能包含 `null` 字符。

- 顶层属性名不能以美元符 (`$`) 开头。但是从MongoDB3.6开始，服务器允许存储包含dots (i.e. `.`) 和 dollar signs (i.e. `$`)的属性名。

  ​    MongoDB查询语言不能一直有意义的表达属性名包含这些字符( [SERVER-30575](https://jira.mongodb.org/browse/SERVER-30575))的文档的查询。直到添加查询语言支持，属性名中$` 和 `. 的使用都不被官方MongoDB驱动建议和支持。

  ​    BSON文档可以有不止一个有相同名称的属性名。但是多数MongoDB接口  [MongoDB interfaces](https://docs.mongodb.com/drivers/)，用数据结构(比如哈希表)表示MongoDB，都不支持重复的属性名。如果你希望操作不止一个相同名称属性名的文档的时候，参考 [driver documentation](https://docs.mongodb.com/drivers/)。

  ​    一些内部MongoDB进程创建的文档可能有多个重复的属性，但是没有任何MongoDB进程会向一个已经存在的用户文档中添加重复属性。

  属性值限制

  ​    MongoDB2.6一直到有 [featureCompatibilityVersion](https://docs.mongodb.com/manual/reference/command/setFeatureCompatibilityVersion/#std-label-view-fcv) **(fCV)** 的MongoDB版本集合，或者更早的，对 [indexed collections](https://docs.mongodb.com/manual/indexes/)，索引属性的值有一个最大索引建长度( [`Maximum Index Key Length`](https://docs.mongodb.com/manual/reference/limits/#mongodb-limit-Index-Key-Limit))。

  点符号

  ​    MongoDB使用点符号访问数组元素和嵌入文档的属性。

  数组

  ​    指定基于0的索引位置指定或者访问一个数组的一个元素，连接数组名称和点符号，基于0的索引位置，加上引号：
```
"<array>.<index>"
```

​    比如对给定的文档中的属性：
```
{
   ...
   contribs: [ "Turing machine", "Turing test", "Turingery" ],
   ...
}
```

​    指定contribs数组的第三个元素，使用点符号"contribs.2"。

​    查询数组的示例：

- [Query an Array](https://docs.mongodb.com/manual/tutorial/query-arrays/)
- [Query an Array of Embedded Documents](https://docs.mongodb.com/manual/tutorial/query-array-of-documents/)

​    另外

- [`$[]`](https://docs.mongodb.com/manual/reference/operator/update/positional-all/#mongodb-update-up.---) 所有位置操作的更新操作。
- [`$[identifier]`](https://docs.mongodb.com/manual/reference/operator/update/positional-filtered/#mongodb-update-up.---identifier--) 过滤更新操作的位置操作。
- [`$`](https://docs.mongodb.com/manual/reference/operator/update/positional/#mongodb-update-up.-) 位置操作的更新操作。
- [`$`](https://docs.mongodb.com/manual/reference/operator/projection/positional/#mongodb-projection-proj.-) 数组索引位置未知的投影操作。
- [Query an Array](https://docs.mongodb.com/manual/tutorial/query-arrays/#std-label-read-operations-arrays) 数组的点符号示例。

嵌入文档

​    使用点符号指定或者访问一个嵌入文档的一个属性，用点符号连接嵌入文档的名称、属性名，加上引号：
```
"<embedded document>.<field>"
```

​    对给定的文档：
```
{
   ...
   name: { first: "Alan", last: "Turing" },
   contact: { phone: { type: "cell", number: "111-222-3333" } },
   ...
}
```

- 使用点符号 `"name.last"`指定name属性中的last属性。
- 使用点符号 `"contact.phone.number"`指定contact属性中的phone文档的number属性。

​    更多示例参考

- [Query on Embedded/Nested Documents](https://docs.mongodb.com/manual/tutorial/query-embedded-documents/)
- [Query an Array of Embedded Documents](https://docs.mongodb.com/manual/tutorial/query-array-of-documents/)

文档限制

​    文档限制有

文档大小限制

​    最大的BSON文档大小是16M。

​    最大文档大小保证单个文档不能使用太多数量的RAM，或者在传输期间太大的带宽。MongoDB提供GridFS API存储比最大大小还要大的文档。参考与你的驱动([driver](https://docs.mongodb.com/drivers/))对应的[`mongofiles`](https://docs.mongodb.com/database-tools/mongofiles/#mongodb-binary-bin.mongofiles)和文档获取更多信息。

文档属性顺序

​    MongoDB
